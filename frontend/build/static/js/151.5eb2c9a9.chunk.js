/*! For license information please see 151.5eb2c9a9.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[151],{4532:(e,t,s)=>{s.r(t),s.d(t,{default:()=>f});var a=s(9379),n=s(5043),i=s(9066),r=s(3986),l=s(2532),c=s(3248),o=s(7097),d=s(8677);const h=["id"],u=e=>(0,l.I)({queryKey:["categories",e],queryFn:async()=>{const t=e?"?type=".concat(e):"";return(await d.A.get("/categories".concat(t))).data}});var p=s(7784);const m=(0,p.A)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),x=(0,p.A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),y=(0,p.A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);var v=s(614),j=s(9989),A=s(9855),g=s(4858),b=s(579);const N=e=>{let{transaction:t,onSubmit:s,onClose:i}=e;const{register:r,handleSubmit:l,watch:c,setValue:o,formState:{errors:d}}=(0,g.mN)({defaultValues:t||{type:"expense",amount:"",category_id:"",description:"",transaction_date:(new Date).toISOString().split("T")[0]}}),h=c("type"),{data:p}=u(h);(0,n.useEffect)(()=>{o("category_id","")},[h,o]);return(0,b.jsx)("div",{className:"modal-overlay",children:(0,b.jsxs)("div",{className:"modal",children:[(0,b.jsxs)("div",{className:"modal-header",children:[(0,b.jsx)("h2",{children:t?"Edit Transaction":"Add Transaction"}),(0,b.jsx)("button",{className:"btn-icon",onClick:i,children:(0,b.jsx)(v.A,{size:24})})]}),(0,b.jsxs)("form",{onSubmit:l(async e=>{await s((0,a.A)((0,a.A)({},e),{},{amount:parseFloat(e.amount),category_id:parseInt(e.category_id)}))}),className:"transaction-form",children:[(0,b.jsxs)("div",{className:"form-row",children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Type"}),(0,b.jsxs)("select",(0,a.A)((0,a.A)({},r("type",{required:"Type is required"})),{},{children:[(0,b.jsx)("option",{value:"income",children:"Income"}),(0,b.jsx)("option",{value:"expense",children:"Expense"})]})),d.type&&(0,b.jsx)("span",{className:"error",children:d.type.message})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Amount"}),(0,b.jsx)("input",(0,a.A)((0,a.A)({type:"number",step:"0.01"},r("amount",{required:"Amount is required",min:{value:.01,message:"Amount must be greater than 0"}})),{},{placeholder:"0.00"})),d.amount&&(0,b.jsx)("span",{className:"error",children:d.amount.message})]})]}),(0,b.jsxs)("div",{className:"form-row",children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Category"}),(0,b.jsxs)("select",(0,a.A)((0,a.A)({},r("category_id",{required:"Category is required"})),{},{children:[(0,b.jsx)("option",{value:"",children:"Select a category"}),null===p||void 0===p?void 0:p.map(e=>(0,b.jsx)("option",{value:e.id,children:e.name},e.id))]})),d.category_id&&(0,b.jsx)("span",{className:"error",children:d.category_id.message})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Date"}),(0,b.jsx)("input",(0,a.A)({type:"date"},r("transaction_date",{required:"Date is required"}))),d.transaction_date&&(0,b.jsx)("span",{className:"error",children:d.transaction_date.message})]})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{children:"Description"}),(0,b.jsx)("textarea",(0,a.A)((0,a.A)({},r("description",{maxLength:{value:500,message:"Description is too long"}})),{},{placeholder:"Enter description (optional)",rows:3})),d.description&&(0,b.jsx)("span",{className:"error",children:d.description.message})]}),(0,b.jsxs)("div",{className:"form-actions",children:[(0,b.jsx)("button",{type:"button",className:"btn-secondary",onClick:i,children:"Cancel"}),(0,b.jsxs)("button",{type:"submit",className:"btn-primary",children:[t?"Update":"Create"," Transaction"]})]})]})]})})},f=()=>{const{hasPermission:e}=(0,i.A)(),t=e(["admin","user"]),[s,p]=(0,n.useState)(1),[g,f]=(0,n.useState)({type:"",category:"",search:"",startDate:"",endDate:""}),[C,k]=(0,n.useState)(!1),[w,S]=(0,n.useState)(null),[D,M]=(0,n.useState)(!1),E=(0,n.useMemo)(()=>(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)({page:s,limit:20},g.type&&{type:g.type}),g.category&&{category:parseInt(g.category)}),g.search&&{search:g.search}),g.startDate&&{startDate:g.startDate}),g.endDate&&{endDate:g.endDate}),[s,g]),{data:q,isLoading:_}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=(0,n.useMemo)(()=>["transactions",e],[e]);return(0,l.I)({queryKey:t,queryFn:async()=>{const t=new URLSearchParams;return Object.entries(e).forEach(e=>{let[s,a]=e;void 0!==a&&null!==a&&t.append(s,String(a))}),(await d.A.get("/transactions?".concat(t))).data}})}(E),{data:O}=u(),K=(()=>{const e=(0,c.jE)();return(0,o.n)({mutationFn:async e=>(await d.A.post("/transactions",e)).data,onSuccess:()=>{e.invalidateQueries({queryKey:["transactions"]}),e.invalidateQueries({queryKey:["analytics"]})}})})(),T=(()=>{const e=(0,c.jE)();return(0,o.n)({mutationFn:async e=>{let{id:t}=e,s=(0,r.A)(e,h);return(await d.A.put("/transactions/".concat(t),s)).data},onSuccess:()=>{e.invalidateQueries({queryKey:["transactions"]}),e.invalidateQueries({queryKey:["analytics"]})}})})(),z=(()=>{const e=(0,c.jE)();return(0,o.n)({mutationFn:async e=>(await d.A.delete("/transactions/".concat(e))).data,onSuccess:()=>{e.invalidateQueries({queryKey:["transactions"]}),e.invalidateQueries({queryKey:["analytics"]})}})})(),L=(0,n.useCallback)(()=>{t&&(S(null),k(!0))},[t]),F=(0,n.useCallback)(e=>{t&&(S(e),k(!0))},[t]),I=(0,n.useCallback)(async e=>{t&&window.confirm("Are you sure you want to delete this transaction?")&&await z.mutateAsync(e)},[t,z]),Q=(0,n.useCallback)(async e=>{w?await T.mutateAsync((0,a.A)({id:w.id},e)):await K.mutateAsync(e),k(!1),S(null)},[w,K,T]),U=(0,n.useCallback)(e=>{const{name:t,value:s}=e.target;f(e=>(0,a.A)((0,a.A)({},e),{},{[t]:s})),p(1)},[]),P=(0,n.useCallback)(()=>{f({type:"",category:"",search:"",startDate:"",endDate:""}),p(1)},[]);return _?(0,b.jsx)("div",{className:"loading",children:"Loading transactions..."}):(0,b.jsxs)("div",{className:"transactions",children:[(0,b.jsxs)("div",{className:"transactions-header",children:[(0,b.jsx)("h1",{children:"Transactions"}),(0,b.jsxs)("div",{className:"header-actions",children:[(0,b.jsxs)("button",{className:"btn-secondary",onClick:()=>M(!D),children:[(0,b.jsx)(m,{size:20}),"Filters"]}),t&&(0,b.jsxs)("button",{className:"btn-primary",onClick:L,children:[(0,b.jsx)(x,{size:20}),"Add Transaction"]})]})]}),D&&(0,b.jsx)("div",{className:"filters-panel",children:(0,b.jsxs)("div",{className:"filters-grid",children:[(0,b.jsxs)("div",{className:"filter-group",children:[(0,b.jsx)("label",{children:"Search"}),(0,b.jsxs)("div",{className:"search-input",children:[(0,b.jsx)(y,{size:18}),(0,b.jsx)("input",{type:"text",name:"search",value:g.search,onChange:U,placeholder:"Search transactions..."})]})]}),(0,b.jsxs)("div",{className:"filter-group",children:[(0,b.jsx)("label",{children:"Type"}),(0,b.jsxs)("select",{name:"type",value:g.type,onChange:U,children:[(0,b.jsx)("option",{value:"",children:"All Types"}),(0,b.jsx)("option",{value:"income",children:"Income"}),(0,b.jsx)("option",{value:"expense",children:"Expense"})]})]}),(0,b.jsxs)("div",{className:"filter-group",children:[(0,b.jsx)("label",{children:"Category"}),(0,b.jsxs)("select",{name:"category",value:g.category,onChange:U,children:[(0,b.jsx)("option",{value:"",children:"All Categories"}),null===O||void 0===O?void 0:O.map(e=>(0,b.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,b.jsxs)("div",{className:"filter-group",children:[(0,b.jsx)("label",{children:"Start Date"}),(0,b.jsx)("input",{type:"date",name:"startDate",value:g.startDate,onChange:U})]}),(0,b.jsxs)("div",{className:"filter-group",children:[(0,b.jsx)("label",{children:"End Date"}),(0,b.jsx)("input",{type:"date",name:"endDate",value:g.endDate,onChange:U})]}),(0,b.jsxs)("button",{className:"btn-text",onClick:P,children:[(0,b.jsx)(v.A,{size:18}),"Clear Filters"]})]})}),(0,b.jsxs)("div",{className:"transactions-table",children:[(0,b.jsxs)("table",{children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Date"}),(0,b.jsx)("th",{children:"Category"}),(0,b.jsx)("th",{children:"Description"}),(0,b.jsx)("th",{children:"Type"}),(0,b.jsx)("th",{children:"Amount"}),t&&(0,b.jsx)("th",{children:"Actions"})]})}),(0,b.jsx)("tbody",{children:null===q||void 0===q?void 0:q.transactions.map(e=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:new Date(e.transaction_date).toLocaleDateString()}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{className:"category-badge",style:{backgroundColor:e.category_color},children:e.category_name})}),(0,b.jsx)("td",{children:e.description}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{className:"type-badge ".concat(e.type),children:e.type})}),(0,b.jsxs)("td",{className:"amount ".concat(e.type),children:["income"===e.type?"+":"-","$",e.amount]}),t&&(0,b.jsx)("td",{children:(0,b.jsxs)("div",{className:"actions",children:[(0,b.jsx)("button",{className:"btn-icon",onClick:()=>F(e),title:"Edit",children:(0,b.jsx)(j.A,{size:16})}),(0,b.jsx)("button",{className:"btn-icon delete",onClick:()=>I(e.id),title:"Delete",children:(0,b.jsx)(A.A,{size:16})})]})})]},e.id))})]}),0===(null===q||void 0===q?void 0:q.transactions.length)&&(0,b.jsx)("div",{className:"empty-state",children:(0,b.jsx)("p",{children:"No transactions found"})})]}),(null===q||void 0===q?void 0:q.pagination)&&q.pagination.pages>1&&(0,b.jsxs)("div",{className:"pagination",children:[(0,b.jsx)("button",{disabled:1===s,onClick:()=>p(e=>e-1),children:"Previous"}),(0,b.jsxs)("span",{children:["Page ",s," of ",q.pagination.pages]}),(0,b.jsx)("button",{disabled:s===q.pagination.pages,onClick:()=>p(e=>e+1),children:"Next"})]}),C&&(0,b.jsx)(N,{transaction:w,onSubmit:Q,onClose:()=>{k(!1),S(null)}})]})}},7097:(e,t,s)=>{s.d(t,{n:()=>f});var a,n,i,r,l,c=s(9379),o=s(5043),d=s(9790),h=s(5149),u=s(8458),p=s(6562),m=s(4558),x=s(5239),y=s(1454),v=s(329),j=s(9723),A=(a=new WeakMap,n=new WeakMap,i=new WeakMap,r=new WeakMap,l=new WeakSet,class extends v.Q{constructor(e,t){super(),(0,d.A)(this,l),(0,h.A)(this,a,void 0),(0,h.A)(this,n,void 0),(0,h.A)(this,i,void 0),(0,h.A)(this,r,void 0),(0,m.A)(a,this,e),this.setOptions(t),this.bindMethods(),(0,p.A)(l,this,g).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var t;const s=this.options;this.options=(0,u.A)(a,this).defaultMutationOptions(e),(0,j.f8)(this.options,s)||(0,u.A)(a,this).getMutationCache().notify({type:"observerOptionsUpdated",mutation:(0,u.A)(i,this),observer:this}),null!==s&&void 0!==s&&s.mutationKey&&this.options.mutationKey&&(0,j.EN)(s.mutationKey)!==(0,j.EN)(this.options.mutationKey)?this.reset():"pending"===(null===(t=(0,u.A)(i,this))||void 0===t?void 0:t.state.status)&&(0,u.A)(i,this).setOptions(this.options)}onUnsubscribe(){var e;this.hasListeners()||(null===(e=(0,u.A)(i,this))||void 0===e||e.removeObserver(this))}onMutationUpdate(e){(0,p.A)(l,this,g).call(this),(0,p.A)(l,this,b).call(this,e)}getCurrentResult(){return(0,u.A)(n,this)}reset(){var e;null===(e=(0,u.A)(i,this))||void 0===e||e.removeObserver(this),(0,m.A)(i,this,void 0),(0,p.A)(l,this,g).call(this),(0,p.A)(l,this,b).call(this)}mutate(e,t){var s;return(0,m.A)(r,this,t),null===(s=(0,u.A)(i,this))||void 0===s||s.removeObserver(this),(0,m.A)(i,this,(0,u.A)(a,this).getMutationCache().build((0,u.A)(a,this),this.options)),(0,u.A)(i,this).addObserver(this),(0,u.A)(i,this).execute(e)}});function g(){var e,t;const s=null!==(e=null===(t=(0,u.A)(i,this))||void 0===t?void 0:t.state)&&void 0!==e?e:(0,x.$)();(0,m.A)(n,this,(0,c.A)((0,c.A)({},s),{},{isPending:"pending"===s.status,isSuccess:"success"===s.status,isError:"error"===s.status,isIdle:"idle"===s.status,mutate:this.mutate,reset:this.reset}))}function b(e){y.jG.batch(()=>{if((0,u.A)(r,this)&&this.hasListeners()){const h=(0,u.A)(n,this).variables,p=(0,u.A)(n,this).context;var t,s,a,i;if("success"===(null===e||void 0===e?void 0:e.type))null===(t=(s=(0,u.A)(r,this)).onSuccess)||void 0===t||t.call(s,e.data,h,p),null===(a=(i=(0,u.A)(r,this)).onSettled)||void 0===a||a.call(i,e.data,null,h,p);else if("error"===(null===e||void 0===e?void 0:e.type)){var l,c,o,d;null===(l=(c=(0,u.A)(r,this)).onError)||void 0===l||l.call(c,e.error,h,p),null===(o=(d=(0,u.A)(r,this)).onSettled)||void 0===o||o.call(d,void 0,e.error,h,p)}}this.listeners.forEach(e=>{e((0,u.A)(n,this))})})}var N=s(3248);function f(e,t){const s=(0,N.jE)(t),[a]=o.useState(()=>new A(s,e));o.useEffect(()=>{a.setOptions(e)},[a,e]);const n=o.useSyncExternalStore(o.useCallback(e=>a.subscribe(y.jG.batchCalls(e)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),i=o.useCallback((e,t)=>{a.mutate(e,t).catch(j.lQ)},[a]);if(n.error&&(0,j.GU)(a.options.throwOnError,[n.error]))throw n.error;return(0,c.A)((0,c.A)({},n),{},{mutate:i,mutateAsync:n.mutate})}},9855:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(7784).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},9989:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(7784).A)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])}}]);
//# sourceMappingURL=151.5eb2c9a9.chunk.js.map